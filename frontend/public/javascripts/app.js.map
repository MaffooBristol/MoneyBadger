{"version":3,"sources":["app/application.coffee","app/collections/data-collection.coffee","app/initialize.coffee","app/lib/router.coffee","app/lib/view_helper.coffee","app/models/collection.coffee","app/models/data-model.coffee","app/models/model.coffee","app/models/state-model.coffee","app/views/chart-view.coffee","app/views/home_view.coffee","app/views/templates/home.hbs","app/views/view.coffee"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhCA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnBA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;AAAA;ACAA;AAAA;AACA;AACA;AAFA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnBA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnBA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlGA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvDA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AALA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/BA;AAAA","file":"public/javascripts/app.js","sourcesContent":["var Application, _dataCollection, _dataModel, _stateModel;\n\n_dataModel = require('models/data-model');\n\n_dataCollection = require('collections/data-collection');\n\n_stateModel = require('models/state-model');\n\nmodule.exports = Application = (function() {\n\n  function Application() {}\n\n  Application.prototype.initialize = function() {\n    var HomeView, Router;\n    HomeView = require('views/home_view');\n    Router = require('lib/router');\n    this.DataCollection = new _dataCollection({\n      model: _dataModel\n    });\n    this.homeView = new HomeView({\n      app: this\n    });\n    this.State = new _stateModel();\n    this.router = new Router();\n    return typeof Object.freeze === \"function\" ? Object.freeze(this) : void 0;\n  };\n\n  return Application;\n\n})();\n\nmodule.exports = new Application();\n","var Collection, app,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\napp = require('application');\n\nmodule.exports = Collection = (function(_super) {\n\n  __extends(Collection, _super);\n\n  function Collection() {\n    return Collection.__super__.constructor.apply(this, arguments);\n  }\n\n  Collection.prototype.url = '/get';\n\n  return Collection;\n\n})(Backbone.Collection);\n","var application;\n\napplication = require('application');\n\n$(function() {\n  application.initialize();\n  return Backbone.history.start();\n});\n","var Router, application,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\napplication = require('application');\n\nmodule.exports = Router = (function(_super) {\n\n  __extends(Router, _super);\n\n  function Router() {\n    return Router.__super__.constructor.apply(this, arguments);\n  }\n\n  Router.prototype.routes = {\n    '': 'home'\n  };\n\n  Router.prototype.home = function() {\n    return $('body').html(application.homeView.render().el);\n  };\n\n  return Router;\n\n})(Backbone.Router);\n","\n\n","var Collection,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = Collection = (function(_super) {\n\n  __extends(Collection, _super);\n\n  function Collection() {\n    return Collection.__super__.constructor.apply(this, arguments);\n  }\n\n  return Collection;\n\n})(Backbone.Collection);\n","var Model,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = Model = (function(_super) {\n\n  __extends(Model, _super);\n\n  function Model() {\n    return Model.__super__.constructor.apply(this, arguments);\n  }\n\n  Model.prototype.defaults = {\n    'Date': '01/01/1970'\n  };\n\n  return Model;\n\n})(Backbone.Model);\n","var Model,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = Model = (function(_super) {\n\n  __extends(Model, _super);\n\n  function Model() {\n    return Model.__super__.constructor.apply(this, arguments);\n  }\n\n  return Model;\n\n})(Backbone.Model);\n","var Model,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = Model = (function(_super) {\n\n  __extends(Model, _super);\n\n  function Model() {\n    return Model.__super__.constructor.apply(this, arguments);\n  }\n\n  Model.prototype.defaults = {\n    'months': 24\n  };\n\n  return Model;\n\n})(Backbone.Model);\n","var ChartView, View, app, dateFormat,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\napp = require('application');\n\nView = require('./view');\n\ndateFormat = 'DD/MM/YYYY';\n\nmodule.exports = ChartView = (function(_super) {\n\n  __extends(ChartView, _super);\n\n  function ChartView() {\n    return ChartView.__super__.constructor.apply(this, arguments);\n  }\n\n  ChartView.prototype.initialize = function(opts) {\n    var _this = this;\n    this.app = opts.app || {};\n    this.collection = opts.collection;\n    this.initialCollection = _.clone(opts.collection);\n    return this.app.State.on('change update', function(val) {\n      return _this.render();\n    });\n  };\n\n  ChartView.prototype.toUnix = function(date) {\n    return moment(date, dateFormat).unix();\n  };\n\n  ChartView.prototype.toDate = function(timestamp) {\n    return moment.unix(timestamp).format(dateFormat);\n  };\n\n  ChartView.prototype.afterRender = function() {\n    var axisItems, chart, date, filtered, i, l, paper, svgElement, x, y, z, _i, _j, _len, _len1, _months, _ref, _ref1, _results, _self,\n      _this = this;\n    _self = this;\n    console.log(this.initialCollection.models.length);\n    this.collection.reset(this.initialCollection.models, {\n      silent: true\n    });\n    svgElement = this.$el;\n    svgElement.empty();\n    paper = Raphael(svgElement.get(0), svgElement.width(), svgElement.height());\n    _months = this.app.State.get('months');\n    if (_months > 0) {\n      filtered = this.collection.filter(function(x) {\n        return _this.toUnix(x.get('Date')) > _this.toUnix(moment().subtract(_months, 'months'));\n      });\n      this.collection.reset(filtered);\n    }\n    x = [];\n    _ref = this.collection.pluck('Date');\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      z = _ref[_i];\n      x.push(this.toUnix(z));\n    }\n    y = [];\n    _ref1 = this.collection.pluck('Balance');\n    for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n      z = _ref1[_j];\n      y.push(z);\n    }\n    console.log(this.toDate(_.min(x)));\n    console.log(this.toDate(_.max(x)));\n    chart = paper.linechart(20, 0, svgElement.width() - 25, svgElement.height() - 20, [x, [_.min(x), _.max(x)]], [y, [1, 1]], {\n      symbol: 'circle',\n      width: 0.5,\n      smooth: false,\n      axis: '0 0 1 1'\n    }).hoverColumn(function(e) {\n      var axis, ting;\n      axis = Math.round(this.axis);\n      ting = _self.collection.find(function(x) {\n        return x.get('Date') === _self.toDate(axis);\n      });\n      if (ting != null) {\n        return $('#description').html(ting.get('Date') + ' : ' + ting.get('Description') + ' / ' + ting.get('Value'));\n      }\n    });\n    axisItems = chart.axis[0].text.items;\n    i = 0;\n    l = axisItems.length;\n    _results = [];\n    while (i < l) {\n      date = axisItems[i].attr(\"text\");\n      axisItems[i].attr(\"text\", this.toDate(date));\n      _results.push(i++);\n    }\n    return _results;\n  };\n\n  return ChartView;\n\n})(View);\n","var ChartView, HomeView, Template, View, app,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\napp = require('application');\n\nView = require('./view');\n\nChartView = require('./chart-view');\n\nTemplate = require('./templates/home');\n\nmodule.exports = HomeView = (function(_super) {\n\n  __extends(HomeView, _super);\n\n  function HomeView() {\n    return HomeView.__super__.constructor.apply(this, arguments);\n  }\n\n  HomeView.prototype.id = 'home-view';\n\n  HomeView.prototype.template = Template;\n\n  HomeView.prototype.initialize = function(opts) {\n    return this.app = opts.app || {};\n  };\n\n  HomeView.prototype.events = {\n    'keyup #months': 'updateMonths'\n  };\n\n  HomeView.prototype.updateMonths = function(e) {\n    return this.app.State.set('months', $(e.target).val());\n  };\n\n  HomeView.prototype.render = function() {\n    var _this = this;\n    this.app.DataCollection.fetch({\n      success: function(_collection) {\n        _this.$el.html(_this.template);\n        _this.chart = new ChartView({\n          collection: _collection,\n          el: _this.$el.find('#chart'),\n          app: _this.app\n        });\n        return _this.chart.render().$el;\n      }\n    });\n    return this;\n  };\n\n  return HomeView;\n\n})(View);\n","module.exports = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {\n  helpers = helpers || Handlebars.helpers;\n  var foundHelper, self=this;\n\n\n  return \"<div id='description'></div>\\n<div id='chart' style='width: 98%; height: 600px;'></div>\\nMonths: <input type='text' id='months' value='24' />\\n<input type='hidden' id='refresh' value='Refresh!' />\\n\";});","var View,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nrequire('lib/view_helper');\n\nmodule.exports = View = (function(_super) {\n\n  __extends(View, _super);\n\n  function View() {\n    this.render = __bind(this.render, this);\n    return View.__super__.constructor.apply(this, arguments);\n  }\n\n  View.prototype.template = function() {};\n\n  View.prototype.getRenderData = function() {};\n\n  View.prototype.render = function() {\n    this.$el.html(this.template(this.getRenderData()));\n    this.afterRender();\n    return this;\n  };\n\n  View.prototype.afterRender = function() {};\n\n  return View;\n\n})(Backbone.View);\n"]}